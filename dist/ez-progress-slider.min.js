angular.module("ez.progressSlider",[]).constant("EzProgressSliderConfig",{draggableTarget:!1,draggableProgress:!0}).directive("ezProgressSlider",["$parse","EzProgressSliderConfig",function(a,b){return{restrict:"EA",templateUrl:"ez-progress-slider-tpl.html",replace:!0,scope:{progress:"=",target:"=?",config:"=?"},link:function(a,c){c.wrap('<div class="ez-progress-slider progress"></div>'),a.options=angular.extend({},b,a.config),a.hasTarget=a.hasOwnProperty("target");var d,e=c[0],f=c.parent(),g=f.parent(),h=e.children[0],i=e.children[1],j=e.children[2],k=parseInt(a.progress,10);console.log("pooo",g.width());var l=function(){d=g.width()},m=function(a){return l(),a?parseInt((a*d/100).toFixed(0),10):0},n=m(k),o=function(){0>=d||(k=Math.round(n/d*100),e.style.width=n+"px",h.style.left=n-10+"px",j.innerHTML=Math.round(k)+"%",a.hasTarget&&(p>k?e.classList.add("progress-bar-danger"):e.classList.remove("progress-bar-danger")))};if(a.options.draggableProgress&&interact(h).draggable({axis:"x",onstart:function(){n=m(k)},onmove:function(a){return n+=a.dx,0>n||n>d?void(n-=a.dx):void o()},onend:function(){a.$apply(function(){a.progress=Math.round(k)})}}).actionChecker(function(a,b){return 3===a.which?null:b}),a.hasTarget){var p=a.target,q=parseInt(m(p),10),r=function(){i.style.left=q-6+"px",i.setAttribute("title",p+"%")};a.options.draggableTarget&&interact(i).draggable({axis:"x",onstart:function(){q=m(p)},onmove:function(a){return q+=a.dx,0>q||q>d?void(q-=a.dx):(p=Math.round(q/d*100),void r())},onend:function(){a.$apply(function(){a.target=Math.round(p)})}}).actionChecker(function(a,b){return 3===a.which?null:b}),r()}else i.remove();f.on("mousedown",function(b){var c=angular.element(b.target);(c.hasClass("ez-progress-slider")||c.hasClass("progress-bar"))&&(n=b.offsetX,o(),a.$apply(function(){a.progress=Math.round(k)}),interact.simulate("drag",h,b))}),o(),setTimeout(function(){e.parentNode.classList.add("ez-loaded")},1e3)}}}]);